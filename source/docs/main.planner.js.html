<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>main.planner.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#@private">@private</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#activateAddBtn">activateAddBtn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#activateBookmarkBtn">activateBookmarkBtn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#activateClearBtn">activateClearBtn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#activateCreateBtn">activateCreateBtn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#activateDeleteBtn">activateDeleteBtn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#activateDrawerEditing">activateDrawerEditing</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#activateSearchBar">activateSearchBar</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#activateSpeechBtn">activateSpeechBtn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#caloriesNinjasNutritions">caloriesNinjasNutritions</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#createIngredientList">createIngredientList</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#createTagList">createTagList</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#deleteCornerBtns">deleteCornerBtns</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getIngredientInfo">getIngredientInfo</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getIngredientSubstitutes">getIngredientSubstitutes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getRecipeInformation">getRecipeInformation</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getSimilarRecipe">getSimilarRecipe</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#id">id</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#ingredientsSearch">ingredientsSearch</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#initializeDrawer">initializeDrawer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#initializeServiceWorker">initializeServiceWorker</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#initializeTooltips">initializeTooltips</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#invalidRecipe">invalidRecipe</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#params">params</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#parseISO">parseISO</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#populateDrawer">populateDrawer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#populateRecipe">populateRecipe</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#recipeDiv">recipeDiv</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#recipeJSON">recipeJSON</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#searchForKey">searchForKey</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#searchRecipe">searchRecipe</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#source">source</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#TIME_FIELDS">TIME_FIELDS</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#userRecipes">userRecipes</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">main.planner.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// main.planner.js

import { searchForKey } from './util.js';

const DAYS_OF_THE_WEEK = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

// Log local storage
console.group('Local storage');
console.log(localStorage);
console.log(`Grocery list (localStorage['meal-planner']):`);
console.log(JSON.parse(localStorage.getItem('meal-planner') || '[]'));
console.groupEnd('Local storage');

// ----- Functions -----
function createCards(recipeArr, source, parent) {
	const templateCard = document.querySelector('.recipe-card');
	recipeArr.forEach((recipe, index) => {
		// Clone new card
		const newCard = templateCard.cloneNode(true);
		newCard.classList.remove('d-none');

		// Thumbnail
		const thumbnail = newCard.querySelector('.thumbnail');
		thumbnail.src = searchForKey(recipe, 'image').url || 'https://via.placeholder.com/288x144?text=No+image+found';
		thumbnail.alt = searchForKey(recipe, 'name');

		// Title
		const title = newCard.querySelector('.title');
		title.textContent = searchForKey(recipe, 'name');
		title.title = title.textContent;
		const params = new URLSearchParams();
		params.append('source', source);
		params.append('id', index);
		title.href = `/recipe.html?${params}`;

		// Add Button
		const addBtn = newCard.querySelector('.add-btn');
		addBtn.addEventListener('click', function () {
			const mealNameInput = document.getElementById('mealName');
			mealNameInput.value = title.textContent;
		});

		parent.appendChild(newCard);
	});
}

// ----- Page Initialization -----
/**
 * Fetch user recipes to populate frontend.
 */
const userRecipes = JSON.parse(localStorage.getItem('recipes')) || [];
createCards(userRecipes, 'user', document.getElementById('userCardGrid'));

let mealPlanner = JSON.parse(localStorage.getItem('meal-planner'));
if (!mealPlanner) {
	const newPlanner = [];
	DAYS_OF_THE_WEEK.forEach((day) => {
		newPlanner.push({
			day: day,
			meals: []
		});
	});
	mealPlanner = newPlanner;
	localStorage.setItem('meal-planner', JSON.stringify(newPlanner));
}

const plannerTableBody = document.getElementById('plannerTableBody');
const emptyRow = document.getElementById('emptyRow');
mealPlanner.forEach((day, index) => {
	day.meals.forEach((meal, mealIndex) => {
		const newRow = emptyRow.cloneNode(true);
		newRow.removeAttribute('id');
		const currentRow = plannerTableBody.children[mealIndex] || plannerTableBody.appendChild(newRow);

		const nameHeading = document.createElement('h5');
		nameHeading.textContent = meal.name;
		currentRow.children[index].appendChild(nameHeading);

		const aboutHeading = document.createElement('h6');
		aboutHeading.classList = 'text-muted';
		aboutHeading.textContent = meal.about;
		currentRow.children[index].appendChild(aboutHeading);

		const deleteBtn = document.createElement('button');
		deleteBtn.classList = 'btn btn-warning';
		const removeSymbol = document.createElement('i');
		removeSymbol.classList = 'fas fa-calendar-minus me-2';
		deleteBtn.appendChild(removeSymbol);
		deleteBtn.append('Remove');
		deleteBtn.addEventListener('click', function () {
			const mealPlanner = JSON.parse(localStorage.getItem('meal-planner'));
			mealPlanner[index].meals.splice(mealIndex, 1);

			localStorage.setItem('meal-planner', JSON.stringify(mealPlanner));

			location.reload();
		});
		currentRow.children[index].appendChild(deleteBtn);
	});
});

const recipeForm = document.getElementById('recipeForm');
recipeForm.addEventListener('submit', function (event) {
	event.preventDefault();

	const formData = new FormData(recipeForm);
	const newMeal = {
		'@type': 'Event',
		name: formData.get('name'),
		about: formData.get('about')
	};

	const mealPlanner = JSON.parse(localStorage.getItem('meal-planner'));
	const dayIndex = parseInt(formData.get('day'));
	mealPlanner[dayIndex].meals.push(newMeal);

	localStorage.setItem('meal-planner', JSON.stringify(mealPlanner));

	location.reload();
});

const clearBtn = document.getElementById('confirmClearBtn');
clearBtn.addEventListener('click', function () {
	localStorage.removeItem('meal-planner');
	location.reload();
});
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Fri Dec 10 2021 07:22:29 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
